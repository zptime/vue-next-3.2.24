{"code":"import { trackOpBit } from './effect';\r\nexport const createDep = (effects) => {\r\n    const dep = new Set(effects);\r\n    dep.w = 0;\r\n    dep.n = 0;\r\n    return dep;\r\n};\r\nexport const wasTracked = (dep) => (dep.w & trackOpBit) > 0;\r\nexport const newTracked = (dep) => (dep.n & trackOpBit) > 0;\r\nexport const initDepMarkers = ({ deps }) => {\r\n    if (deps.length) {\r\n        for (let i = 0; i < deps.length; i++) {\r\n            deps[i].w |= trackOpBit; // set was tracked\r\n        }\r\n    }\r\n};\r\nexport const finalizeDepMarkers = (effect) => {\r\n    const { deps } = effect;\r\n    if (deps.length) {\r\n        let ptr = 0;\r\n        for (let i = 0; i < deps.length; i++) {\r\n            const dep = deps[i];\r\n            if (wasTracked(dep) && !newTracked(dep)) {\r\n                dep.delete(effect);\r\n            }\r\n            else {\r\n                deps[ptr++] = dep;\r\n            }\r\n            // clear bits\r\n            dep.w &= ~trackOpBit;\r\n            dep.n &= ~trackOpBit;\r\n        }\r\n        deps.length = ptr;\r\n    }\r\n};\r\n//# sourceMappingURL=dep.js.map","references":["/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/reactivity/src/effect.ts"],"map":"{\"version\":3,\"file\":\"dep.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../packages/reactivity/src/dep.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAkB,UAAU,EAAE,MAAM,UAAU,CAAA;AAoBrD,MAAM,CAAC,MAAM,SAAS,GAAG,CAAC,OAA0B,EAAO,EAAE;IAC3D,MAAM,GAAG,GAAG,IAAI,GAAG,CAAiB,OAAO,CAAQ,CAAA;IACnD,GAAG,CAAC,CAAC,GAAG,CAAC,CAAA;IACT,GAAG,CAAC,CAAC,GAAG,CAAC,CAAA;IACT,OAAO,GAAG,CAAA;AACZ,CAAC,CAAA;AAED,MAAM,CAAC,MAAM,UAAU,GAAG,CAAC,GAAQ,EAAW,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,UAAU,CAAC,GAAG,CAAC,CAAA;AAEzE,MAAM,CAAC,MAAM,UAAU,GAAG,CAAC,GAAQ,EAAW,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,UAAU,CAAC,GAAG,CAAC,CAAA;AAEzE,MAAM,CAAC,MAAM,cAAc,GAAG,CAAC,EAAE,IAAI,EAAkB,EAAE,EAAE;IACzD,IAAI,IAAI,CAAC,MAAM,EAAE;QACf,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACpC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,UAAU,CAAA,CAAC,kBAAkB;SAC3C;KACF;AACH,CAAC,CAAA;AAED,MAAM,CAAC,MAAM,kBAAkB,GAAG,CAAC,MAAsB,EAAE,EAAE;IAC3D,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,CAAA;IACvB,IAAI,IAAI,CAAC,MAAM,EAAE;QACf,IAAI,GAAG,GAAG,CAAC,CAAA;QACX,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACpC,MAAM,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAA;YACnB,IAAI,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE;gBACvC,GAAG,CAAC,MAAM,CAAC,MAAM,CAAC,CAAA;aACnB;iBAAM;gBACL,IAAI,CAAC,GAAG,EAAE,CAAC,GAAG,GAAG,CAAA;aAClB;YACD,aAAa;YACb,GAAG,CAAC,CAAC,IAAI,CAAC,UAAU,CAAA;YACpB,GAAG,CAAC,CAAC,IAAI,CAAC,UAAU,CAAA;SACrB;QACD,IAAI,CAAC,MAAM,GAAG,GAAG,CAAA;KAClB;AACH,CAAC,CAAA\"}"}
