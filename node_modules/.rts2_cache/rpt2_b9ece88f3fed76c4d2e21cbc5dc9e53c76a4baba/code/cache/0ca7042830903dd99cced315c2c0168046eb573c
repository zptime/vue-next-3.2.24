{"code":"import { ReactiveEffect } from './effect';\r\nimport { trackRefValue, triggerRefValue } from './ref';\r\nimport { isFunction, NOOP } from '@vue/shared';\r\nimport { toRaw } from './reactive';\r\nclass ComputedRefImpl {\r\n    constructor(getter, _setter, isReadonly) {\r\n        this._setter = _setter;\r\n        this.dep = undefined;\r\n        this._dirty = true;\r\n        this.__v_isRef = true;\r\n        this.effect = new ReactiveEffect(getter, () => {\r\n            if (!this._dirty) {\r\n                this._dirty = true;\r\n                triggerRefValue(this);\r\n            }\r\n        });\r\n        this[\"__v_isReadonly\" /* IS_READONLY */] = isReadonly;\r\n    }\r\n    get value() {\r\n        // the computed ref may get wrapped by other proxies e.g. readonly() #3376\r\n        const self = toRaw(this);\r\n        trackRefValue(self);\r\n        if (self._dirty) {\r\n            self._dirty = false;\r\n            self._value = self.effect.run();\r\n        }\r\n        return self._value;\r\n    }\r\n    set value(newValue) {\r\n        this._setter(newValue);\r\n    }\r\n}\r\n\"__v_isReadonly\" /* IS_READONLY */;\r\nexport function computed(getterOrOptions, debugOptions) {\r\n    let getter;\r\n    let setter;\r\n    const onlyGetter = isFunction(getterOrOptions);\r\n    if (onlyGetter) {\r\n        getter = getterOrOptions;\r\n        setter = __DEV__\r\n            ? () => {\r\n                console.warn('Write operation failed: computed value is readonly');\r\n            }\r\n            : NOOP;\r\n    }\r\n    else {\r\n        getter = getterOrOptions.get;\r\n        setter = getterOrOptions.set;\r\n    }\r\n    const cRef = new ComputedRefImpl(getter, setter, onlyGetter || !setter);\r\n    if (__DEV__ && debugOptions) {\r\n        cRef.effect.onTrack = debugOptions.onTrack;\r\n        cRef.effect.onTrigger = debugOptions.onTrigger;\r\n    }\r\n    return cRef;\r\n}\r\n//# sourceMappingURL=computed.js.map","references":["/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/reactivity/src/effect.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/reactivity/src/ref.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/shared/src/index.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/reactivity/src/reactive.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/reactivity/src/dep.ts"],"map":"{\"version\":3,\"file\":\"computed.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../packages/reactivity/src/computed.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAmB,cAAc,EAAE,MAAM,UAAU,CAAA;AAC1D,OAAO,EAAO,aAAa,EAAE,eAAe,EAAE,MAAM,OAAO,CAAA;AAC3D,OAAO,EAAE,UAAU,EAAE,IAAI,EAAE,MAAM,aAAa,CAAA;AAC9C,OAAO,EAAiB,KAAK,EAAE,MAAM,YAAY,CAAA;AAsBjD,MAAM,eAAe;IAUnB,YACE,MAAyB,EACR,OAA0B,EAC3C,UAAmB;QADF,YAAO,GAAP,OAAO,CAAmB;QAXtC,QAAG,GAAS,SAAS,CAAA;QAGpB,WAAM,GAAG,IAAI,CAAA;QAGL,cAAS,GAAG,IAAI,CAAA;QAQ9B,IAAI,CAAC,MAAM,GAAG,IAAI,cAAc,CAAC,MAAM,EAAE,GAAG,EAAE;YAC5C,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;gBAChB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAA;gBAClB,eAAe,CAAC,IAAI,CAAC,CAAA;aACtB;QACH,CAAC,CAAC,CAAA;QACF,IAAI,oCAA2B,GAAG,UAAU,CAAA;IAC9C,CAAC;IAED,IAAI,KAAK;QACP,0EAA0E;QAC1E,MAAM,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,CAAA;QACxB,aAAa,CAAC,IAAI,CAAC,CAAA;QACnB,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,MAAM,GAAG,KAAK,CAAA;YACnB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,EAAG,CAAA;SACjC;QACD,OAAO,IAAI,CAAC,MAAM,CAAA;IACpB,CAAC;IAED,IAAI,KAAK,CAAC,QAAW;QACnB,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAA;IACxB,CAAC;CACF;;AAUD,MAAM,UAAU,QAAQ,CACtB,eAA+D,EAC/D,YAA8B;IAE9B,IAAI,MAAyB,CAAA;IAC7B,IAAI,MAAyB,CAAA;IAE7B,MAAM,UAAU,GAAG,UAAU,CAAC,eAAe,CAAC,CAAA;IAC9C,IAAI,UAAU,EAAE;QACd,MAAM,GAAG,eAAe,CAAA;QACxB,MAAM,GAAG,OAAO;YACd,CAAC,CAAC,GAAG,EAAE;gBACH,OAAO,CAAC,IAAI,CAAC,oDAAoD,CAAC,CAAA;YACpE,CAAC;YACH,CAAC,CAAC,IAAI,CAAA;KACT;SAAM;QACL,MAAM,GAAG,eAAe,CAAC,GAAG,CAAA;QAC5B,MAAM,GAAG,eAAe,CAAC,GAAG,CAAA;KAC7B;IAED,MAAM,IAAI,GAAG,IAAI,eAAe,CAAC,MAAM,EAAE,MAAM,EAAE,UAAU,IAAI,CAAC,MAAM,CAAC,CAAA;IAEvE,IAAI,OAAO,IAAI,YAAY,EAAE;QAC3B,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,YAAY,CAAC,OAAO,CAAA;QAC1C,IAAI,CAAC,MAAM,CAAC,SAAS,GAAG,YAAY,CAAC,SAAS,CAAA;KAC/C;IAED,OAAO,IAAW,CAAA;AACpB,CAAC\"}"}
