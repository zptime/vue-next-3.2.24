{"code":"import { camelize, EMPTY_OBJ, toHandlerKey, extend, hasOwn, hyphenate, isArray, isFunction, isOn, toNumber } from '@vue/shared';\r\nimport { formatComponentName } from './component';\r\nimport { callWithAsyncErrorHandling } from './errorHandling';\r\nimport { warn } from './warning';\r\nimport { devtoolsComponentEmit } from './devtools';\r\nimport { emit as compatInstanceEmit } from './compat/instanceEventEmitter';\r\nimport { compatModelEventPrefix, compatModelEmit } from './compat/componentVModel';\r\nexport function emit(instance, event, ...rawArgs) {\r\n    const props = instance.vnode.props || EMPTY_OBJ;\r\n    if (__DEV__) {\r\n        const { emitsOptions, propsOptions: [propsOptions] } = instance;\r\n        if (emitsOptions) {\r\n            if (!(event in emitsOptions) &&\r\n                !(__COMPAT__ &&\r\n                    (event.startsWith('hook:') ||\r\n                        event.startsWith(compatModelEventPrefix)))) {\r\n                if (!propsOptions || !(toHandlerKey(event) in propsOptions)) {\r\n                    warn(`Component emitted event \"${event}\" but it is neither declared in ` +\r\n                        `the emits option nor as an \"${toHandlerKey(event)}\" prop.`);\r\n                }\r\n            }\r\n            else {\r\n                const validator = emitsOptions[event];\r\n                if (isFunction(validator)) {\r\n                    const isValid = validator(...rawArgs);\r\n                    if (!isValid) {\r\n                        warn(`Invalid event arguments: event validation failed for event \"${event}\".`);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    let args = rawArgs;\r\n    const isModelListener = event.startsWith('update:');\r\n    // for v-model update:xxx events, apply modifiers on args\r\n    const modelArg = isModelListener && event.slice(7);\r\n    if (modelArg && modelArg in props) {\r\n        const modifiersKey = `${modelArg === 'modelValue' ? 'model' : modelArg}Modifiers`;\r\n        const { number, trim } = props[modifiersKey] || EMPTY_OBJ;\r\n        if (trim) {\r\n            args = rawArgs.map(a => a.trim());\r\n        }\r\n        else if (number) {\r\n            args = rawArgs.map(toNumber);\r\n        }\r\n    }\r\n    if (__DEV__ || __FEATURE_PROD_DEVTOOLS__) {\r\n        devtoolsComponentEmit(instance, event, args);\r\n    }\r\n    if (__DEV__) {\r\n        const lowerCaseEvent = event.toLowerCase();\r\n        if (lowerCaseEvent !== event && props[toHandlerKey(lowerCaseEvent)]) {\r\n            warn(`Event \"${lowerCaseEvent}\" is emitted in component ` +\r\n                `${formatComponentName(instance, instance.type)} but the handler is registered for \"${event}\". ` +\r\n                `Note that HTML attributes are case-insensitive and you cannot use ` +\r\n                `v-on to listen to camelCase events when using in-DOM templates. ` +\r\n                `You should probably use \"${hyphenate(event)}\" instead of \"${event}\".`);\r\n        }\r\n    }\r\n    let handlerName;\r\n    let handler = props[(handlerName = toHandlerKey(event))] ||\r\n        // also try camelCase event handler (#2249)\r\n        props[(handlerName = toHandlerKey(camelize(event)))];\r\n    // for v-model update:xxx events, also trigger kebab-case equivalent\r\n    // for props passed via kebab-case\r\n    if (!handler && isModelListener) {\r\n        handler = props[(handlerName = toHandlerKey(hyphenate(event)))];\r\n    }\r\n    if (handler) {\r\n        callWithAsyncErrorHandling(handler, instance, 6 /* COMPONENT_EVENT_HANDLER */, args);\r\n    }\r\n    const onceHandler = props[handlerName + `Once`];\r\n    if (onceHandler) {\r\n        if (!instance.emitted) {\r\n            instance.emitted = {};\r\n        }\r\n        else if (instance.emitted[handlerName]) {\r\n            return;\r\n        }\r\n        instance.emitted[handlerName] = true;\r\n        callWithAsyncErrorHandling(onceHandler, instance, 6 /* COMPONENT_EVENT_HANDLER */, args);\r\n    }\r\n    if (__COMPAT__) {\r\n        compatModelEmit(instance, event, args);\r\n        return compatInstanceEmit(instance, event, args);\r\n    }\r\n}\r\nexport function normalizeEmitsOptions(comp, appContext, asMixin = false) {\r\n    const cache = appContext.emitsCache;\r\n    const cached = cache.get(comp);\r\n    if (cached !== undefined) {\r\n        return cached;\r\n    }\r\n    const raw = comp.emits;\r\n    let normalized = {};\r\n    // apply mixin/extends props\r\n    let hasExtends = false;\r\n    if (__FEATURE_OPTIONS_API__ && !isFunction(comp)) {\r\n        const extendEmits = (raw) => {\r\n            const normalizedFromExtend = normalizeEmitsOptions(raw, appContext, true);\r\n            if (normalizedFromExtend) {\r\n                hasExtends = true;\r\n                extend(normalized, normalizedFromExtend);\r\n            }\r\n        };\r\n        if (!asMixin && appContext.mixins.length) {\r\n            appContext.mixins.forEach(extendEmits);\r\n        }\r\n        if (comp.extends) {\r\n            extendEmits(comp.extends);\r\n        }\r\n        if (comp.mixins) {\r\n            comp.mixins.forEach(extendEmits);\r\n        }\r\n    }\r\n    if (!raw && !hasExtends) {\r\n        cache.set(comp, null);\r\n        return null;\r\n    }\r\n    if (isArray(raw)) {\r\n        raw.forEach(key => (normalized[key] = null));\r\n    }\r\n    else {\r\n        extend(normalized, raw);\r\n    }\r\n    cache.set(comp, normalized);\r\n    return normalized;\r\n}\r\n// Check if an incoming prop key is a declared emit event listener.\r\n// e.g. With `emits: { click: null }`, props named `onClick` and `onclick` are\r\n// both considered matched listeners.\r\nexport function isEmitListener(options, key) {\r\n    if (!options || !isOn(key)) {\r\n        return false;\r\n    }\r\n    if (__COMPAT__ && key.startsWith(compatModelEventPrefix)) {\r\n        return true;\r\n    }\r\n    key = key.slice(2).replace(/Once$/, '');\r\n    return (hasOwn(options, key[0].toLowerCase() + key.slice(1)) ||\r\n        hasOwn(options, hyphenate(key)) ||\r\n        hasOwn(options, key));\r\n}\r\n//# sourceMappingURL=componentEmits.js.map","references":["/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/shared/src/index.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/runtime-core/src/component.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/runtime-core/src/errorHandling.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/runtime-core/src/warning.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/runtime-core/src/helpers/typeUtils.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/runtime-core/src/devtools.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/runtime-core/src/apiCreateApp.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/runtime-core/src/compat/instanceEventEmitter.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/runtime-core/src/compat/componentVModel.ts"],"map":"{\"version\":3,\"file\":\"componentEmits.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../packages/runtime-core/src/componentEmits.ts\"],\"names\":[],\"mappings\":\"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\"}"}
