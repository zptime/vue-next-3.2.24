{"code":"import { transformModel as baseTransform, findProp, hasDynamicKeyVBind } from '@vue/compiler-core';\r\nimport { createDOMCompilerError } from '../errors';\r\nimport { V_MODEL_CHECKBOX, V_MODEL_RADIO, V_MODEL_SELECT, V_MODEL_TEXT, V_MODEL_DYNAMIC } from '../runtimeHelpers';\r\nexport const transformModel = (dir, node, context) => {\r\n    const baseResult = baseTransform(dir, node, context);\r\n    // base transform has errors OR component v-model (only need props)\r\n    if (!baseResult.props.length || node.tagType === 1 /* COMPONENT */) {\r\n        return baseResult;\r\n    }\r\n    if (dir.arg) {\r\n        context.onError(createDOMCompilerError(55 /* X_V_MODEL_ARG_ON_ELEMENT */, dir.arg.loc));\r\n    }\r\n    function checkDuplicatedValue() {\r\n        const value = findProp(node, 'value');\r\n        if (value) {\r\n            context.onError(createDOMCompilerError(57 /* X_V_MODEL_UNNECESSARY_VALUE */, value.loc));\r\n        }\r\n    }\r\n    const { tag } = node;\r\n    const isCustomElement = context.isCustomElement(tag);\r\n    if (tag === 'input' ||\r\n        tag === 'textarea' ||\r\n        tag === 'select' ||\r\n        isCustomElement) {\r\n        let directiveToUse = V_MODEL_TEXT;\r\n        let isInvalidType = false;\r\n        if (tag === 'input' || isCustomElement) {\r\n            const type = findProp(node, `type`);\r\n            if (type) {\r\n                if (type.type === 7 /* DIRECTIVE */) {\r\n                    // :type=\"foo\"\r\n                    directiveToUse = V_MODEL_DYNAMIC;\r\n                }\r\n                else if (type.value) {\r\n                    switch (type.value.content) {\r\n                        case 'radio':\r\n                            directiveToUse = V_MODEL_RADIO;\r\n                            break;\r\n                        case 'checkbox':\r\n                            directiveToUse = V_MODEL_CHECKBOX;\r\n                            break;\r\n                        case 'file':\r\n                            isInvalidType = true;\r\n                            context.onError(createDOMCompilerError(56 /* X_V_MODEL_ON_FILE_INPUT_ELEMENT */, dir.loc));\r\n                            break;\r\n                        default:\r\n                            // text type\r\n                            __DEV__ && checkDuplicatedValue();\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n            else if (hasDynamicKeyVBind(node)) {\r\n                // element has bindings with dynamic keys, which can possibly contain\r\n                // \"type\".\r\n                directiveToUse = V_MODEL_DYNAMIC;\r\n            }\r\n            else {\r\n                // text type\r\n                __DEV__ && checkDuplicatedValue();\r\n            }\r\n        }\r\n        else if (tag === 'select') {\r\n            directiveToUse = V_MODEL_SELECT;\r\n        }\r\n        else {\r\n            // textarea\r\n            __DEV__ && checkDuplicatedValue();\r\n        }\r\n        // inject runtime directive\r\n        // by returning the helper symbol via needRuntime\r\n        // the import will replaced a resolveDirective call.\r\n        if (!isInvalidType) {\r\n            baseResult.needRuntime = context.helper(directiveToUse);\r\n        }\r\n    }\r\n    else {\r\n        context.onError(createDOMCompilerError(54 /* X_V_MODEL_ON_INVALID_ELEMENT */, dir.loc));\r\n    }\r\n    // native vmodel doesn't need the `modelValue` props since they are also\r\n    // passed to the runtime as `binding.value`. removing it reduces code size.\r\n    baseResult.props = baseResult.props.filter(p => !(p.key.type === 4 /* SIMPLE_EXPRESSION */ &&\r\n        p.key.content === 'modelValue'));\r\n    return baseResult;\r\n};\r\n//# sourceMappingURL=vModel.js.map","references":["/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/compiler-core/src/index.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/compiler-dom/src/errors.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/compiler-dom/src/runtimeHelpers.ts"],"map":"{\"version\":3,\"file\":\"vModel.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../packages/compiler-dom/src/transforms/vModel.ts\"],\"names\":[],\"mappings\":\"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\"}"}
