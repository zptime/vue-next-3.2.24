{"code":"import { isObject, toRawType, def } from '@vue/shared';\r\nimport { mutableHandlers, readonlyHandlers, shallowReactiveHandlers, shallowReadonlyHandlers } from './baseHandlers';\r\nimport { mutableCollectionHandlers, readonlyCollectionHandlers, shallowCollectionHandlers, shallowReadonlyCollectionHandlers } from './collectionHandlers';\r\nexport const reactiveMap = new WeakMap();\r\nexport const shallowReactiveMap = new WeakMap();\r\nexport const readonlyMap = new WeakMap();\r\nexport const shallowReadonlyMap = new WeakMap();\r\nfunction targetTypeMap(rawType) {\r\n    switch (rawType) {\r\n        case 'Object':\r\n        case 'Array':\r\n            return 1 /* COMMON */;\r\n        case 'Map':\r\n        case 'Set':\r\n        case 'WeakMap':\r\n        case 'WeakSet':\r\n            return 2 /* COLLECTION */;\r\n        default:\r\n            return 0 /* INVALID */;\r\n    }\r\n}\r\nfunction getTargetType(value) {\r\n    return value[\"__v_skip\" /* SKIP */] || !Object.isExtensible(value)\r\n        ? 0 /* INVALID */\r\n        : targetTypeMap(toRawType(value));\r\n}\r\nexport function reactive(target) {\r\n    // if trying to observe a readonly proxy, return the readonly version.\r\n    if (target && target[\"__v_isReadonly\" /* IS_READONLY */]) {\r\n        return target;\r\n    }\r\n    return createReactiveObject(target, false, mutableHandlers, mutableCollectionHandlers, reactiveMap);\r\n}\r\n/**\r\n * Return a shallowly-reactive copy of the original object, where only the root\r\n * level properties are reactive. It also does not auto-unwrap refs (even at the\r\n * root level).\r\n */\r\nexport function shallowReactive(target) {\r\n    return createReactiveObject(target, false, shallowReactiveHandlers, shallowCollectionHandlers, shallowReactiveMap);\r\n}\r\n/**\r\n * Creates a readonly copy of the original object. Note the returned copy is not\r\n * made reactive, but `readonly` can be called on an already reactive object.\r\n */\r\nexport function readonly(target) {\r\n    return createReactiveObject(target, true, readonlyHandlers, readonlyCollectionHandlers, readonlyMap);\r\n}\r\n/**\r\n * Returns a reactive-copy of the original object, where only the root level\r\n * properties are readonly, and does NOT unwrap refs nor recursively convert\r\n * returned properties.\r\n * This is used for creating the props proxy object for stateful components.\r\n */\r\nexport function shallowReadonly(target) {\r\n    return createReactiveObject(target, true, shallowReadonlyHandlers, shallowReadonlyCollectionHandlers, shallowReadonlyMap);\r\n}\r\nfunction createReactiveObject(target, isReadonly, baseHandlers, collectionHandlers, proxyMap) {\r\n    if (!isObject(target)) {\r\n        if (__DEV__) {\r\n            console.warn(`value cannot be made reactive: ${String(target)}`);\r\n        }\r\n        return target;\r\n    }\r\n    // target is already a Proxy, return it.\r\n    // exception: calling readonly() on a reactive object\r\n    if (target[\"__v_raw\" /* RAW */] &&\r\n        !(isReadonly && target[\"__v_isReactive\" /* IS_REACTIVE */])) {\r\n        return target;\r\n    }\r\n    // target already has corresponding Proxy\r\n    const existingProxy = proxyMap.get(target);\r\n    if (existingProxy) {\r\n        return existingProxy;\r\n    }\r\n    // only a whitelist of value types can be observed.\r\n    const targetType = getTargetType(target);\r\n    if (targetType === 0 /* INVALID */) {\r\n        return target;\r\n    }\r\n    const proxy = new Proxy(target, targetType === 2 /* COLLECTION */ ? collectionHandlers : baseHandlers);\r\n    proxyMap.set(target, proxy);\r\n    return proxy;\r\n}\r\nexport function isReactive(value) {\r\n    if (isReadonly(value)) {\r\n        return isReactive(value[\"__v_raw\" /* RAW */]);\r\n    }\r\n    return !!(value && value[\"__v_isReactive\" /* IS_REACTIVE */]);\r\n}\r\nexport function isReadonly(value) {\r\n    return !!(value && value[\"__v_isReadonly\" /* IS_READONLY */]);\r\n}\r\nexport function isProxy(value) {\r\n    return isReactive(value) || isReadonly(value);\r\n}\r\nexport function toRaw(observed) {\r\n    const raw = observed && observed[\"__v_raw\" /* RAW */];\r\n    return raw ? toRaw(raw) : observed;\r\n}\r\nexport function markRaw(value) {\r\n    def(value, \"__v_skip\" /* SKIP */, true);\r\n    return value;\r\n}\r\nexport const toReactive = (value) => isObject(value) ? reactive(value) : value;\r\nexport const toReadonly = (value) => isObject(value) ? readonly(value) : value;\r\n//# sourceMappingURL=reactive.js.map","references":["/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/shared/src/index.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/reactivity/src/baseHandlers.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/reactivity/src/collectionHandlers.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/reactivity/src/ref.ts"],"map":"{\"version\":3,\"file\":\"reactive.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../packages/reactivity/src/reactive.ts\"],\"names\":[],\"mappings\":\"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\"}"}
