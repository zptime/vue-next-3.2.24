{"code":"import { findDir, makeBlock } from '../utils';\r\nimport { createCallExpression, createFunctionExpression } from '../ast';\r\nimport { WITH_MEMO } from '../runtimeHelpers';\r\nconst seen = new WeakSet();\r\nexport const transformMemo = (node, context) => {\r\n    if (node.type === 1 /* ELEMENT */) {\r\n        const dir = findDir(node, 'memo');\r\n        if (!dir || seen.has(node)) {\r\n            return;\r\n        }\r\n        seen.add(node);\r\n        return () => {\r\n            const codegenNode = node.codegenNode ||\r\n                context.currentNode.codegenNode;\r\n            if (codegenNode && codegenNode.type === 13 /* VNODE_CALL */) {\r\n                // non-component sub tree should be turned into a block\r\n                if (node.tagType !== 1 /* COMPONENT */) {\r\n                    makeBlock(codegenNode, context);\r\n                }\r\n                node.codegenNode = createCallExpression(context.helper(WITH_MEMO), [\r\n                    dir.exp,\r\n                    createFunctionExpression(undefined, codegenNode),\r\n                    `_cache`,\r\n                    String(context.cached++)\r\n                ]);\r\n            }\r\n        };\r\n    }\r\n};\r\n//# sourceMappingURL=vMemo.js.map","references":["/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/compiler-core/src/transform.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/compiler-core/src/utils.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/compiler-core/src/ast.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/compiler-core/src/runtimeHelpers.ts"],"map":"{\"version\":3,\"file\":\"vMemo.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../packages/compiler-core/src/transforms/vMemo.ts\"],\"names\":[],\"mappings\":\"AACA,OAAO,EAAE,OAAO,EAAE,SAAS,EAAE,MAAM,UAAU,CAAA;AAC7C,OAAO,EACL,oBAAoB,EACpB,wBAAwB,EAKzB,MAAM,QAAQ,CAAA;AACf,OAAO,EAAE,SAAS,EAAE,MAAM,mBAAmB,CAAA;AAE7C,MAAM,IAAI,GAAG,IAAI,OAAO,EAAE,CAAA;AAE1B,MAAM,CAAC,MAAM,aAAa,GAAkB,CAAC,IAAI,EAAE,OAAO,EAAE,EAAE;IAC5D,IAAI,IAAI,CAAC,IAAI,oBAAsB,EAAE;QACnC,MAAM,GAAG,GAAG,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC,CAAA;QACjC,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;YAC1B,OAAM;SACP;QACD,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA;QACd,OAAO,GAAG,EAAE;YACV,MAAM,WAAW,GACf,IAAI,CAAC,WAAW;gBACf,OAAO,CAAC,WAAgC,CAAC,WAAW,CAAA;YACvD,IAAI,WAAW,IAAI,WAAW,CAAC,IAAI,wBAAyB,EAAE;gBAC5D,uDAAuD;gBACvD,IAAI,IAAI,CAAC,OAAO,sBAA2B,EAAE;oBAC3C,SAAS,CAAC,WAAW,EAAE,OAAO,CAAC,CAAA;iBAChC;gBACD,IAAI,CAAC,WAAW,GAAG,oBAAoB,CAAC,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE;oBACjE,GAAG,CAAC,GAAI;oBACR,wBAAwB,CAAC,SAAS,EAAE,WAAW,CAAC;oBAChD,QAAQ;oBACR,MAAM,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;iBACzB,CAAmB,CAAA;aACrB;QACH,CAAC,CAAA;KACF;AACH,CAAC,CAAA\"}"}
