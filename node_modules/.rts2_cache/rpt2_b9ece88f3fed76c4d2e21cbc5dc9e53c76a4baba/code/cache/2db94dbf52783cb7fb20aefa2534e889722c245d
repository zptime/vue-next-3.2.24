{"code":"import { warn, pushWarningContext, popWarningContext } from './warning';\r\nimport { isPromise, isFunction } from '@vue/shared';\r\nexport const ErrorTypeStrings = {\r\n    [\"sp\" /* SERVER_PREFETCH */]: 'serverPrefetch hook',\r\n    [\"bc\" /* BEFORE_CREATE */]: 'beforeCreate hook',\r\n    [\"c\" /* CREATED */]: 'created hook',\r\n    [\"bm\" /* BEFORE_MOUNT */]: 'beforeMount hook',\r\n    [\"m\" /* MOUNTED */]: 'mounted hook',\r\n    [\"bu\" /* BEFORE_UPDATE */]: 'beforeUpdate hook',\r\n    [\"u\" /* UPDATED */]: 'updated',\r\n    [\"bum\" /* BEFORE_UNMOUNT */]: 'beforeUnmount hook',\r\n    [\"um\" /* UNMOUNTED */]: 'unmounted hook',\r\n    [\"a\" /* ACTIVATED */]: 'activated hook',\r\n    [\"da\" /* DEACTIVATED */]: 'deactivated hook',\r\n    [\"ec\" /* ERROR_CAPTURED */]: 'errorCaptured hook',\r\n    [\"rtc\" /* RENDER_TRACKED */]: 'renderTracked hook',\r\n    [\"rtg\" /* RENDER_TRIGGERED */]: 'renderTriggered hook',\r\n    [0 /* SETUP_FUNCTION */]: 'setup function',\r\n    [1 /* RENDER_FUNCTION */]: 'render function',\r\n    [2 /* WATCH_GETTER */]: 'watcher getter',\r\n    [3 /* WATCH_CALLBACK */]: 'watcher callback',\r\n    [4 /* WATCH_CLEANUP */]: 'watcher cleanup function',\r\n    [5 /* NATIVE_EVENT_HANDLER */]: 'native event handler',\r\n    [6 /* COMPONENT_EVENT_HANDLER */]: 'component event handler',\r\n    [7 /* VNODE_HOOK */]: 'vnode hook',\r\n    [8 /* DIRECTIVE_HOOK */]: 'directive hook',\r\n    [9 /* TRANSITION_HOOK */]: 'transition hook',\r\n    [10 /* APP_ERROR_HANDLER */]: 'app errorHandler',\r\n    [11 /* APP_WARN_HANDLER */]: 'app warnHandler',\r\n    [12 /* FUNCTION_REF */]: 'ref function',\r\n    [13 /* ASYNC_COMPONENT_LOADER */]: 'async component loader',\r\n    [14 /* SCHEDULER */]: 'scheduler flush. This is likely a Vue internals bug. ' +\r\n        'Please open an issue at https://new-issue.vuejs.org/?repo=vuejs/vue-next'\r\n};\r\nexport function callWithErrorHandling(fn, instance, type, args) {\r\n    let res;\r\n    try {\r\n        res = args ? fn(...args) : fn();\r\n    }\r\n    catch (err) {\r\n        handleError(err, instance, type);\r\n    }\r\n    return res;\r\n}\r\nexport function callWithAsyncErrorHandling(fn, instance, type, args) {\r\n    if (isFunction(fn)) {\r\n        const res = callWithErrorHandling(fn, instance, type, args);\r\n        if (res && isPromise(res)) {\r\n            res.catch(err => {\r\n                handleError(err, instance, type);\r\n            });\r\n        }\r\n        return res;\r\n    }\r\n    const values = [];\r\n    for (let i = 0; i < fn.length; i++) {\r\n        values.push(callWithAsyncErrorHandling(fn[i], instance, type, args));\r\n    }\r\n    return values;\r\n}\r\nexport function handleError(err, instance, type, throwInDev = true) {\r\n    const contextVNode = instance ? instance.vnode : null;\r\n    if (instance) {\r\n        let cur = instance.parent;\r\n        // the exposed instance is the render proxy to keep it consistent with 2.x\r\n        const exposedInstance = instance.proxy;\r\n        // in production the hook receives only the error code\r\n        const errorInfo = __DEV__ ? ErrorTypeStrings[type] : type;\r\n        while (cur) {\r\n            const errorCapturedHooks = cur.ec;\r\n            if (errorCapturedHooks) {\r\n                for (let i = 0; i < errorCapturedHooks.length; i++) {\r\n                    if (errorCapturedHooks[i](err, exposedInstance, errorInfo) === false) {\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n            cur = cur.parent;\r\n        }\r\n        // app-level handling\r\n        const appErrorHandler = instance.appContext.config.errorHandler;\r\n        if (appErrorHandler) {\r\n            callWithErrorHandling(appErrorHandler, null, 10 /* APP_ERROR_HANDLER */, [err, exposedInstance, errorInfo]);\r\n            return;\r\n        }\r\n    }\r\n    logError(err, type, contextVNode, throwInDev);\r\n}\r\nfunction logError(err, type, contextVNode, throwInDev = true) {\r\n    if (__DEV__) {\r\n        const info = ErrorTypeStrings[type];\r\n        if (contextVNode) {\r\n            pushWarningContext(contextVNode);\r\n        }\r\n        warn(`Unhandled error${info ? ` during execution of ${info}` : ``}`);\r\n        if (contextVNode) {\r\n            popWarningContext();\r\n        }\r\n        // crash in dev by default so it's more noticeable\r\n        if (throwInDev) {\r\n            throw err;\r\n        }\r\n        else if (!__TEST__) {\r\n            console.error(err);\r\n        }\r\n    }\r\n    else {\r\n        // recover in prod to reduce the impact on end-user\r\n        console.error(err);\r\n    }\r\n}\r\n//# sourceMappingURL=errorHandling.js.map","references":["/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/runtime-core/src/vnode.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/runtime-core/src/component.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/runtime-core/src/warning.ts","/Users/zhangpian/Documents/projects/github/vue-next-3.2.24/packages/shared/src/index.ts"],"map":"{\"version\":3,\"file\":\"errorHandling.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../packages/runtime-core/src/errorHandling.ts\"],\"names\":[],\"mappings\":\"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\"}"}
